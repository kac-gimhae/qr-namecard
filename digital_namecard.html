<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>디지털 명함 · KAC</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #7C211E;
    --primary-light: #A63B38;
    --accent: #D4726A;
    --accent-glow: rgba(124, 33, 30, 0.12);
    --bg: #F7F9FC;
    --card: #FFFFFF;
    --text: #1A2B3C;
    --text-secondary: #5A6B7C;
    --border: #E2E8F0;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    background-image:
      radial-gradient(ellipse at 20% 50%, rgba(124,33,30,0.04) 0%, transparent 50%),
      radial-gradient(ellipse at 80% 20%, rgba(212,114,106,0.04) 0%, transparent 50%);
  }
  .card-wrapper {
    width: 100%;
    max-width: 420px;
    animation: fadeUp 0.8s cubic-bezier(0.22,1,0.36,1) both;
  }
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .card {
    background: var(--card);
    border-radius: 20px;
    overflow: hidden;
    box-shadow:
      0 1px 3px rgba(0,0,0,0.04),
      0 8px 24px rgba(124,33,30,0.08),
      0 20px 60px rgba(124,33,30,0.04);
  }
  .card-header {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 60%, var(--accent) 100%);
    padding: 36px 28px 28px;
    position: relative;
    overflow: hidden;
  }
  .card-header::before {
    content: '';
    position: absolute;
    top: -40%; right: -20%;
    width: 300px; height: 300px;
    background: radial-gradient(circle, rgba(255,255,255,0.06) 0%, transparent 70%);
    border-radius: 50%;
  }
  .card-header::after {
    content: '';
    position: absolute;
    bottom: -60%; left: -10%;
    width: 200px; height: 200px;
    background: radial-gradient(circle, rgba(212,114,106,0.12) 0%, transparent 70%);
    border-radius: 50%;
  }
  .logo-area {
    margin-bottom: 20px; position: relative; z-index: 1;
  }
  .logo-area img {
    height: 25px;
    filter: grayscale(1) brightness(10);
  }
  .name-area { position: relative; z-index: 1; }
  .name-primary {
    font-size: 28px; font-weight: 700; color: #fff;
    letter-spacing: 2px; margin-bottom: 2px;
  }
  .name-secondary {
    font-family: 'Playfair Display', serif;
    font-size: 15px; color: rgba(255,255,255,0.7);
    font-weight: 600; letter-spacing: 0.5px;
  }
  .title-badge {
    display: inline-block; margin-top: 14px;
    padding: 5px 14px;
    background: rgba(255,255,255,0.12);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 20px;
    color: rgba(255,255,255,0.95);
    font-size: 15px; font-weight: 400;
    backdrop-filter: blur(10px); letter-spacing: 0.5px;
  }
  .card-body { padding: 24px 28px; }
  .dept-info {
    font-size: 14px; color: var(--text-secondary); line-height: 1.6;
    padding-bottom: 20px; border-bottom: 1px solid var(--border); margin-bottom: 20px;
  }
  .dept-info .line1 { font-weight: 500; color: var(--text); }
  .dept-info .line2 { font-weight: 500; color: var(--text); margin-top: 2px; }
  .contact-list { display: flex; flex-direction: column; gap: 14px; }
  .contact-item {
    display: flex; align-items: center; gap: 14px;
    text-decoration: none; color: var(--text);
    padding: 10px 14px; border-radius: 12px;
    transition: all 0.2s ease; cursor: pointer;
  }
  .contact-item:hover { background: var(--accent-glow); }
  .contact-item:active { transform: scale(0.98); }
  .contact-icon {
    width: 40px; height: 40px; border-radius: 10px;
    display: flex; align-items: center; justify-content: center; flex-shrink: 0;
  }
  .contact-icon.phone { background: linear-gradient(135deg, #E8F5E9, #C8E6C9); }
  .contact-icon.phone svg { stroke: #2E7D32; }
  .contact-icon.office { background: linear-gradient(135deg, #FDECEA, #F5C6C2); }
  .contact-icon.office svg { stroke: var(--primary); }
  .contact-icon.email { background: linear-gradient(135deg, #FFF3E0, #FFE0B2); }
  .contact-icon.email svg { stroke: #E65100; }
  .contact-icon svg {
    width: 20px; height: 20px; fill: none;
    stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;
  }
  .contact-info .label {
    font-size: 11px; color: var(--text-secondary);
    font-weight: 500; letter-spacing: 0.5px;
    text-transform: uppercase; margin-bottom: 2px;
  }
  .contact-info .value {
    font-size: 15px; font-weight: 500; color: var(--text); letter-spacing: 0.3px;
  }
  .save-section { padding: 8px 28px 28px; }
  .save-btn {
    display: flex; align-items: center; justify-content: center; gap: 10px;
    width: 100%; padding: 15px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
    color: white; border: none; border-radius: 14px;
    font-size: 15px; font-weight: 600;
    font-family: 'Noto Sans KR', sans-serif;
    cursor: pointer; transition: all 0.25s ease;
    box-shadow: 0 4px 15px rgba(124,33,30,0.3); letter-spacing: 0.5px;
  }
  .save-btn:hover { transform: translateY(-1px); box-shadow: 0 6px 20px rgba(124,33,30,0.4); }
  .save-btn:active { transform: translateY(0); }
  .save-btn svg {
    width: 20px; height: 20px; fill: none;
    stroke: white; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;
  }
  .save-success { background: linear-gradient(135deg, #2E7D32, #43A047) !important; }
  .android-hint {
    margin-top: 10px; font-size: 11.5px; color: var(--text-secondary);
    line-height: 1.5; text-align: center;
  }
  .lang-toggle {
    display: flex; justify-content: center; gap: 8px;
    padding: 0 28px 20px;
  }
  .lang-btn {
    padding: 6px 16px; border-radius: 8px;
    font-size: 12px; font-weight: 500;
    cursor: pointer; transition: all 0.2s;
    border: 1.5px solid var(--border);
    background: transparent; color: var(--text-secondary);
    font-family: 'Noto Sans KR', sans-serif;
  }
  .lang-btn.active {
    background: var(--primary); color: white; border-color: var(--primary);
  }
  .card-footer { padding: 0 28px 24px; text-align: center; }
  .footer-text { font-size: 11px; color: #B0BEC5; letter-spacing: 0.3px; }
  .toast {
    position: fixed; bottom: 30px; left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: var(--text); color: white;
    padding: 12px 24px; border-radius: 12px;
    font-size: 14px; font-weight: 500; opacity: 0;
    transition: all 0.4s cubic-bezier(0.22,1,0.36,1);
    z-index: 100; box-shadow: 0 8px 30px rgba(0,0,0,0.2);
  }
  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
</style>
</head>
<body>

<div class="card-wrapper">
  <div class="card">
    <div class="card-header">
      <div class="logo-area">
        <img src="01-1.png" alt="한국공항공사 김해공항">
      </div>
      <div class="name-area">
        <div class="name-primary" id="namePrimary"></div>
        <div class="name-secondary" id="nameSecondary"></div>
        <div class="title-badge" id="titleBadge"></div>
      </div>
    </div>

    <div class="card-body">
      <div class="dept-info" id="deptInfo">
        <div class="line1" id="deptLine1"></div>
        <div class="line2" id="deptLine2"></div>
      </div>
      <div class="contact-list">
        <a id="cellRow" href="#" class="contact-item">
          <div class="contact-icon phone">
            <svg viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/></svg>
          </div>
          <div class="contact-info">
            <div class="label" id="labelCell"></div>
            <div class="value" id="cellValue"></div>
          </div>
        </a>
        <a id="workRow" href="#" class="contact-item">
          <div class="contact-icon office">
            <svg viewBox="0 0 24 24"><path d="M4 4h16a2 2 0 012 2v12a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2z"/><path d="M2 8h20M8 4v16"/></svg>
          </div>
          <div class="contact-info">
            <div class="label" id="labelWork"></div>
            <div class="value" id="workValue"></div>
          </div>
        </a>
        <a id="emailRow" href="#" class="contact-item">
          <div class="contact-icon email">
            <svg viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
          </div>
          <div class="contact-info">
            <div class="label" id="labelEmail"></div>
            <div class="value" id="emailValue"></div>
          </div>
        </a>
      </div>
    </div>

    <div class="save-section">
      <button class="save-btn" id="saveBtn" onclick="saveContact()">
        <svg viewBox="0 0 24 24"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
        <span id="saveBtnText"></span>
      </button>
      <p class="android-hint" id="androidHint"></p>
    </div>

    <div class="lang-toggle">
      <button class="lang-btn active" id="btnKo" onclick="setLang('ko')">한국어</button>
      <button class="lang-btn" id="btnEn" onclick="setLang('en')">English</button>
    </div>

    <div class="card-footer">
      <div class="footer-text">KOREA AIRPORTS CORPORATION · GIMHAE INTERNATIONAL AIRPORT</div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// === URL 파라미터 파싱 ===
const P = new URLSearchParams(window.location.search);
const DATA = {
  nameKo:    P.get('n')  || '',
  enFirst:   P.get('ef') || '',
  enLast:    P.get('el') || '',
  deptKo:    P.get('d')  || '',
  deptEn:    P.get('de') || '',
  titleKo:   P.get('t')  || '',
  titleEn:   P.get('te') || '',
  cell:      P.get('c')  || '',
  workExt:   P.get('w')  || '',
  emailId:   P.get('e')  || ''
};

// === 전화번호 포맷 ===
function formatPhoneDisplay(raw) {
  if (!raw) return '';
  var d = raw.replace(/[^0-9]/g, '');
  if (d.length === 11) return d.replace(/(\d{3})(\d{4})(\d{4})/, '$1-$2-$3');
  if (d.length === 10) return d.replace(/(\d{3})(\d{3})(\d{4})/, '$1-$2-$3');
  return d;
}

function formatPhoneIntl(raw) {
  if (!raw) return '';
  var d = raw.replace(/[^0-9]/g, '');
  if (d.startsWith('0')) {
    return '+82-' + d.substring(1).replace(/(\d{1,2})(\d{3,4})(\d{4})/, '$1-$2-$3');
  }
  return raw;
}

// === 데이터 조합 ===
var workRaw = '051974' + DATA.workExt;
var emailFull = DATA.emailId + '@airport.co.kr';
var cellIntl = DATA.cell ? formatPhoneIntl(DATA.cell) : '';
var workIntl = formatPhoneIntl(workRaw);
var cellDisplay = DATA.cell ? formatPhoneDisplay(DATA.cell) : '';
var workDisplay = formatPhoneDisplay(workRaw);
var enFullName = DATA.enFirst + ' ' + DATA.enLast;

// 한글 이름 띄어쓰기 (김지수 → 김 지 수)
var nameKoSpaced = DATA.nameKo.split('').join(' ');

// === 페이지 타이틀 ===
document.title = DATA.nameKo + ' | ' + enFullName + ' · KAC';

// === 언어별 데이터 ===
var hasCell = DATA.cell.length > 0;
var hasDept = DATA.deptKo.length > 0;

var vcards = {
  ko: [
    'BEGIN:VCARD',
    'VERSION:3.0',
    'N:' + DATA.nameKo + ';;;;',
    'FN:한국공항공사(김해공항) ' + DATA.nameKo + ' ' + DATA.titleKo,
    hasDept ? 'ORG:한국공항공사 김해공항;' + DATA.deptKo : 'ORG:한국공항공사 김해공항',
    'TITLE:' + DATA.titleKo,
    hasCell ? 'TEL;TYPE=CELL:' + cellIntl : '',
    'TEL;TYPE=WORK:' + workIntl,
    'EMAIL;TYPE=WORK:' + emailFull,
    'END:VCARD'
  ].filter(Boolean).join('\n'),
  en: [
    'BEGIN:VCARD',
    'VERSION:3.0',
    'N:' + DATA.enLast + ';' + DATA.enFirst + ';;;',
    'FN:' + enFullName + ' (KAC Gimhae Airport)',
    hasDept ? 'ORG:Gimhae International Airport, Korea Airports Corporation;' + DATA.deptEn : 'ORG:Gimhae International Airport, Korea Airports Corporation',
    'TITLE:' + DATA.titleEn,
    hasCell ? 'TEL;TYPE=CELL:' + cellIntl : '',
    'TEL;TYPE=WORK:' + workIntl,
    'EMAIL;TYPE=WORK:' + emailFull,
    'END:VCARD'
  ].filter(Boolean).join('\n')
};

var ui = {
  ko: {
    namePrimary: nameKoSpaced,
    nameSecondary: '',
    titleBadge: DATA.titleKo,
    deptLine1: hasDept ? '한국공항공사 김해공항 ' + DATA.deptKo : '한국공항공사 김해공항',
    deptLine2: '',
    labelCell: '휴대전화',
    labelWork: '직장전화',
    labelEmail: '이메일',
    saveBtnText: '연락처 저장하기',
    androidHint: 'Android(삼성 등) 사용자: 버튼을 누른 뒤 다운로드된 파일을 열어 연락처를 가져오세요.',
    toastMsg: '연락처가 저장됩니다',
    saveSuccess: '저장 완료!'
  },
  en: {
    namePrimary: enFullName,
    nameSecondary: '',
    titleBadge: DATA.titleEn,
    deptLine1: hasDept ? DATA.deptEn : 'Gimhae International Airport',
    deptLine2: hasDept ? 'Gimhae International Airport<br>Korea Airports Corporation' : 'Korea Airports Corporation',
    labelCell: 'MOBILE',
    labelWork: 'OFFICE',
    labelEmail: 'EMAIL',
    saveBtnText: 'Save Contact',
    androidHint: 'Android (Samsung, etc.): After tapping the button, open the downloaded file to import the contact.',
    toastMsg: 'Saving contact',
    saveSuccess: 'Saved!'
  }
};

// === 휴대폰 없으면 행 숨기기 ===
if (!hasCell) {
  document.getElementById('cellRow').style.display = 'none';
}

// === 연락처 href 설정 ===
if (hasCell) {
  var cellTel = cellIntl.replace(/-/g, '');
  document.getElementById('cellRow').href = 'tel:' + cellTel;
  document.getElementById('cellValue').textContent = cellDisplay;
}
var workTel = workIntl.replace(/-/g, '');
document.getElementById('workRow').href = 'tel:' + workTel;
document.getElementById('workValue').textContent = workDisplay;
document.getElementById('emailRow').href = 'mailto:' + emailFull;
document.getElementById('emailValue').textContent = emailFull;

// === 언어 전환 ===
let currentLang = 'ko';

function setLang(lang) {
  currentLang = lang;
  var d = ui[lang];
  document.getElementById('namePrimary').textContent = d.namePrimary;
  document.getElementById('nameSecondary').textContent = d.nameSecondary;
  document.getElementById('titleBadge').textContent = d.titleBadge;
  document.getElementById('deptLine1').textContent = d.deptLine1;
  document.getElementById('deptLine2').innerHTML = d.deptLine2;
  if (hasCell) document.getElementById('labelCell').textContent = d.labelCell;
  document.getElementById('labelWork').textContent = d.labelWork;
  document.getElementById('labelEmail').textContent = d.labelEmail;
  document.getElementById('saveBtnText').textContent = d.saveBtnText;
  document.getElementById('androidHint').textContent = d.androidHint;

  document.getElementById('btnKo').classList.toggle('active', lang === 'ko');
  document.getElementById('btnEn').classList.toggle('active', lang === 'en');
}

// === 연락처 저장 (iOS/Android 모두 Blob URL 직접 이동) ===
function saveContact() {
  var vcard = vcards[currentLang];
  var isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);

  if (isIOS) {
    // iOS: text/vcard blob URL → Safari 연락처 앱 직접 실행
    var blob = new Blob([vcard], { type: 'text/vcard' });
    window.location.href = URL.createObjectURL(blob);
  } else {
    // Android: text/x-vcard blob URL → OS 연락처 핸들러 직접 실행
    var blob = new Blob([vcard], { type: 'text/x-vcard' });
    window.location.href = URL.createObjectURL(blob);
  }

  var btn = document.getElementById('saveBtn');
  var d = ui[currentLang];
  btn.classList.add('save-success');
  btn.innerHTML = '<svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg> ' + d.saveSuccess;
  showToast(d.toastMsg);

  setTimeout(function() {
    btn.classList.remove('save-success');
    btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg> <span>' + d.saveBtnText + '</span>';
  }, 3000);
}

function showToast(msg) {
  var toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.classList.add('show');
  setTimeout(function() { toast.classList.remove('show'); }, 2500);
}

// === 초기 언어 설정 ===
(function() {
  var lang = (navigator.language || navigator.userLanguage || 'ko').toLowerCase();
  if (lang.startsWith('ko')) {
    setLang('ko');
  } else {
    setLang('en');
  }
})();
</script>
</body>
</html>
